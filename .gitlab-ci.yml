# Continuous Integration testing for KHARMA
# a.k.a did we break the basics?

# Build against a container image
#image:

variables:
  GIT_SUBMODULE_STRATEGY: recursive
  EXTRA_FLAGS: -DPARTHENON_DISABLE_MPI=ON

stages:
  - build
  - convergence

build:
  stage: build
  script:
    - bash make.sh clean
  artifacts:
    paths:
      - kharma.*

bondi:
  stage: convergence
  before_script:
    - cd tests/bondi/
  script:
    - bash run.sh
    - bash check.sh
  after_script:
    - cd ../..
  artifacts:
    paths:
      - tests/bondi/*.png

mhdmodes:
  stage: convergence
  before_script:
    - cd tests/mhdmodes/
  script:
    - bash run.sh
    - bash check.sh
  after_script:
    - cd ../..
  artifacts:
    paths:
      - tests/mhdmodes/*.png
